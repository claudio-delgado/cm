<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <title>Medieval colonies - alpha 1.0 - Home</title>

    <link href="v6.7.2/css/all.css" rel="stylesheet" />
    <link href="v6.7.2/css/sharp-solid.css" rel="stylesheet" />
    <link href="v6.7.2/css/sharp-regular.css" rel="stylesheet" />
    <!-- Uncomment this link when debugging -->
    <!--link href="https://cdn.jsdelivr.net/npm/flowbite@3.1.2/dist/flowbite.min.css" rel="stylesheet" -->
    <!-- Comment this when debugging -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/flowbite@3.1.2/dist/flowbite.min.js"></script>
    <script src="js/classes/numeric.js"></script>
    <script src="js/useful.arrays.js"></script>
    <script src="js/classes/webworker/time_worker.js"></script>
    <script src="js/classes/functions.js"></script>
    <script src="js/classes/dom.js"></script>
    <script src="js/classes/modal.js"></script>
    <script src="js/classes/game_time.js"></script>
    <script src="js/classes/news.js"></script>
    <script src="js/classes/colony.js"></script>
    <script src="js/classes/building.js"></script>
    <script src="js/classes/citizen.js"></script>
    <script src="js/classes/pregnancy.js"></script>
    <script src="js/classes/relationship.js"></script>
    <script src="js/classes/landform.js"></script>
    <script src="js/classes/expedition.js"></script>
    <script src="js/init.js"></script>
    <script src="js/i18n.js"></script>
    <script src="js/functions.js"></script>
    <script src="js/panel.js"></script>
    <script src="js/export_template.js"></script>

    <script type="module">
        //Module to export the game progress to a json file.
        import { JSONFile } from './js/modules/json.js'
        import { Progress } from './js/modules/progress.js'
        import { ModalBox } from './js/modules/modal.js'
        
        document.getElementById('resetProgress').addEventListener('click', (e) => {
            let data = {"paragraphs":[
                "You are about to reset all life progress in your colony!", 
                "This means that after resetting current progress, all previous progress will be deleted.", 
                "If you are decided to restart your game choose 'Ok', otherwise choose 'Cancel'."
            ]}
            let p_modal = new ModalBox("modalProgress")
            p_modal.build()
            p_modal.progress_modal("Warning!", data)
            p_modal.show()
            document.getElementById("modalBoxFooterButton1").classList.remove("hidden")
            document.getElementById("modalBoxFooterButton1").addEventListener("click", (e) => {
                localStorage.removeItem("colony")
                if(document.activeElement) document.activeElement.blur() 
                p_modal.hide()
                let data = {"paragraphs":["Progress updated successfully. Let's go to home page and check the changes."]}
                p_modal.progress_modal("Warning!", data)
                document.getElementById("modalBoxFooterButton1").classList.add("hidden")
                document.getElementById("modalBoxFooterButton2").innerHTML = translate(language, "Ok")
                document.getElementById("modalBoxFooterButton2").onclick = () => { window.location.href = "home.html" }
                p_modal.show()
            })
            document.getElementById("modalBoxFooterButton2").classList.remove("hidden")
            document.getElementById("modalBoxFooterButton2").innerHTML = translate(language, "Cancel")
            document.getElementById("modalBoxFooterButton2").addEventListener("click", (e) => {
                if(document.activeElement) document.activeElement.blur() 
                p_modal.hide()
            })
        })
        document.getElementById('saveProgress').addEventListener('click', (e) => {
            let data = {"paragraphs":[
                "You are about to change all life progress in your colony!", 
                "This means that after saving current progress, all previous progress will be replaced by the new one.", 
                "If you are decided to update your progress choose 'Ok', otherwise choose 'Cancel'."
            ]}
            let p_modal = new ModalBox("modalProgress")
            p_modal.build()
            p_modal.progress_modal("Warning!", data)
            p_modal.show()
            document.getElementById("modalBoxFooterButton1").classList.remove("hidden")
            document.getElementById("modalBoxFooterButton1").addEventListener("click", (e) => {
                if(document.activeElement) document.activeElement.blur()
                let game_progress = new Progress()
                game_progress.build_data()
                game_progress.save_localstorage()
                p_modal.hide()
                let data = {"paragraphs":["Progress updated successfully. Let's go to home page and check the changes."]}
                p_modal.progress_modal("Warning!", data)
                document.getElementById("modalBoxFooterButton1").classList.add("hidden")
                document.getElementById("modalBoxFooterButton2").innerHTML = translate(language, "Ok")
                document.getElementById("modalBoxFooterButton2").onclick = () => { window.location.href = "home.html" }
                p_modal.show()
            })
            document.getElementById("modalBoxFooterButton2").classList.remove("hidden")
            document.getElementById("modalBoxFooterButton2").innerHTML = translate(language, "Cancel")
            document.getElementById("modalBoxFooterButton2").addEventListener("click", (e) => {
                if(document.activeElement) document.activeElement.blur() 
                p_modal.hide()
            })

        })
        document.getElementById('exportProgress').addEventListener('click', (e) => {
            e.target.closest('div').classList.add('hidden')
            let exported_json = new JSONFile()
            exported_json.export()
            return false
        });
    </script>
    <!--script src="https://kit.fontawesome.com/2743a5dc06.js" crossorigin="anonymous"></script-->
    <link href="home.css" rel="stylesheet" />
    <style>
    </style>
</head>
<body class="">
    <header class="sticky top-0 z-40">
        <nav class="bg-white border-gray-200 dark:bg-gray-900 mb-3">
            <div class="max-w-screen-xl flex flex-wrap items-center justify-between mx-auto p-4 py-2">
                <a href="./index.html" class="flex items-center space-x-3 rtl:space-x-reverse">
                    <img src="logo.svg" class="h-8" alt="Flowbite Logo" />
                    <div>
                        <p class="font-serif text-white text-lg font-semibold m-0 p-0" data-i18n>Medieval colonies</p>
                        <p class="text-white text-xs font-thin m-0 p-0"><span data-i18n="navbar.subtitle1">Non graphical alpha version</span> <span class="font-bold" id="game_version">1.0</span></p>
                    </div>
                </a>
                <button data-collapse-toggle="navbar-default" type="button" class="inline-flex items-center p-2 w-10 h-10 justify-center text-sm text-gray-500 rounded-lg md:hidden hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-gray-200 dark:text-gray-400 dark:hover:bg-gray-700 dark:focus:ring-gray-600" aria-controls="navbar-default" aria-expanded="false">
                    <span class="sr-only">Open main menu</span>
                    <svg class="w-5 h-5" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 17 14">
                        <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M1 1h15M1 7h15M1 13h15"/>
                    </svg>
                </button>
                <div class="w-full md:block md:w-auto" id="navbar-default">
                    <ul class="font-medium flex flex-col p-1 md:p-0 mt-4 border border-gray-100 rounded-lg bg-gray-50 md:flex-row md:space-x-8 rtl:space-x-reverse md:mt-0 md:border-0 md:bg-white dark:bg-gray-800 md:dark:bg-gray-900 dark:border-gray-700">
                        <li>
                            <button id="dropdownLanguage" data-dropdown-toggle="dropdownNavbarLanguage" class="flex items-center justify-between w-full py-1 px-3 text-gray-900 rounded-sm hover:bg-gray-100 md:hover:bg-transparent md:border-0 md:hover:text-blue-700 md:p-0 md:w-auto dark:text-white md:dark:hover:text-blue-500 dark:focus:text-white dark:border-gray-700 dark:hover:bg-gray-700 md:dark:hover:bg-transparent"><span data-i18n="navbar.menu.language">Language</span>
                                <svg class="w-2.5 h-2.5 ms-2.5" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 10 6">
                                    <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m1 1 4 4 4-4"/>
                                </svg>
                            </button>
                            <!-- Dropdown menu -->
                            <div id="dropdownNavbarLanguage" class="z-10 hidden font-normal bg-white divide-y divide-gray-100 rounded-lg shadow-sm w-44 dark:bg-gray-700 dark:divide-gray-600">
                                <ul class="py-1 text-sm text-gray-700 dark:text-gray-400" aria-labelledby="dropdownLargeButton">
                                    <li>
                                        <a onclick="translate_all('ES'); return false;" class="block px-4 py-2 hover:bg-gray-100 dark:hover:bg-gray-600 dark:hover:text-white">Espa√±ol</a>
                                    </li>
                                    <li>
                                        <a onclick="translate_all('EN'); return false;" class="block px-4 py-2 hover:bg-gray-100 dark:hover:bg-gray-600 dark:hover:text-white">English</a>
                                    </li>
                                </ul>
                            </div>
                        </li>
                        <li>
                            <button id="dropdownProgress" data-dropdown-toggle="dropdownNavbarProgress" class="flex items-center justify-between w-full py-1 px-3 text-gray-900 rounded-sm hover:bg-gray-100 md:hover:bg-transparent md:border-0 md:hover:text-blue-700 md:p-0 md:w-auto dark:text-white md:dark:hover:text-blue-500 dark:focus:text-white dark:border-gray-700 dark:hover:bg-gray-700 md:dark:hover:bg-transparent">
                                <span data-i18n="navbar.menu.progress">Game progress</span>
                                <svg class="w-2.5 h-2.5 ms-2.5" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 10 6">
                                    <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m1 1 4 4 4-4"/>
                                </svg>
                            </button>
                            <div id="dropdownNavbarProgress" class="z-10 hidden font-normal bg-white divide-y divide-gray-100 rounded-lg shadow-sm w-44 dark:bg-gray-700 dark:divide-gray-600">
                                <ul class="py-1 text-sm text-gray-700 dark:text-gray-400" aria-labelledby="dropdownLargeButton">
                                    <li>
                                        <a id="resetProgress" onclick="this.closest('div').classList.add('hidden')" class="block px-4 py-2 hover:bg-gray-100 dark:hover:bg-gray-600 dark:hover:text-white" data-i18n>Reset</a>
                                    </li>
                                    <li>
                                        <a id="saveProgress" onclick="this.closest('div').classList.add('hidden')" class="block px-4 py-2 hover:bg-gray-100 dark:hover:bg-gray-600 dark:hover:text-white" data-i18n>Save</a>
                                    </li>
                                    <li>
                                        <a href="upload.html" class="block px-4 py-2 hover:bg-gray-100 dark:hover:bg-gray-600 dark:hover:text-white" data-i18n>Import</a>
                                    </li>
                                    <li>
                                        <a id="exportProgress" onclick="" class="block px-4 py-2 hover:bg-gray-100 dark:hover:bg-gray-600 dark:hover:text-white" data-i18n>Export</a>
                                    </li>
                                </ul>
                            </div>
                        </li>
                        <li>
                            <a href="#" class="block py-2 px-3 text-white rounded-sm md:bg-transparent md:text-blue-700 md:p-0 dark:text-white md:dark:text-blue-500" aria-current="page" data-i18n>Quit game</a>
                        </li>
                    </ul>
                </div>
            </div>
            <div class="max-w-screen-xl text-xs dark:text-white dark:bg-gray-800 border-gray-100 flex flex-wrap justify-between mx-auto p-2">
                <div><span data-i18n>Weeks lived</span> : <span class="font-bold" id="passedWeeks">0</span></div>
                <div class="justify-end px-1 rounded border border-gray-500"><span id='yearDef'><span data-i18n>Year</span> <span class="font-bold" id="currentYear">1</span></span> <span id='weekDef'><span class="capital" data-i18n>Week</span> <span class="font-bold" id="currentWeek">1</span></span> <span id='dayDef'><span class="capital" data-i18n>Day</span> <span class="font-bold" id="currentDay">1</span></span> <span id="currentHour">00</span></div>
            </div>
        </nav>
    </header>
    <div id="accordion-menu" class="mx-2 mb-2 z-0" data-accordion="collapse">
        <div id="gameOverDiv" class="hidden max-w-screen-xl my-1 text-xs text-white bg-red-900 border border-gray-100 mx-auto p-2">
            <p class="flex flex-wrap items-center"><i class="text-sm fa fa-face-frown me-1"></i><span data-i18n>Your game is over.</span></p>
            <p class="pt-2"><span><span data-i18n>You can start a new one by clicking</span>: <span class="font-bold" data-i18n>Game progress</span> + <span class="font-bold" data-i18n>Reset</span> <span data-i18n>in the upper menu.</span></span></p>
        </div>
    </div>  
    <!-- Main modal -->
    <div id="modalPopup" tabindex="-1" aria-hidden="true" class="hidden overflow-y-auto overflow-x-hidden fixed top-0 right-0 left-0 z-50 justify-center items-center w-full md:inset-0 h-[calc(100%-1rem)] max-h-full">
        <div class="relative px-3 mx-0 w-full">
            <div class="relative bg-white rounded-lg shadow-sm dark:bg-gray-700">
                <div class="flex items-center justify-between p-4 md:p-5 border-b rounded-t dark:border-gray-600 border-gray-200">
                    <h3 id='modalTitle' data-i18n class="text-xl font-semibold text-gray-900 dark:text-white"></h3>
                    <button type="button" class="text-gray-400 bg-transparent hover:bg-gray-200 hover:text-gray-900 rounded-lg text-sm w-8 h-8 ms-auto inline-flex justify-center items-center dark:hover:bg-gray-600 dark:hover:text-white" data-modal-hide="modalPopup">
                        <svg class="w-3 h-3" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 14 14">
                            <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m1 1 6 6m0 0 6 6M7 7l6-6M7 7l-6 6"/>
                        </svg>
                        <span class="sr-only">Close modal</span>
                    </button>
                </div>
                <div id="modalBody" class="p-4">
                </div>
                <div id="modalFooter" class="flex items-center p-4 md:p-5 border-t border-gray-200 rounded-b dark:border-gray-600">
                    <button id="modalFooterButton1" data-i18n data-modal-hide="modalPopup" type="button" class="text-white bg-blue-700 hover:bg-blue-800 focus:ring-4 focus:outline-none focus:ring-blue-300 font-medium rounded-lg text-sm px-5 py-2.5 text-center dark:bg-blue-600 dark:hover:bg-blue-700 dark:focus:ring-blue-800"></button>
                    <button id="modalFooterButton2" data-i18n data-modal-hide="modalPopup" type="button" class="hidden text-white bg-blue-700 hover:bg-blue-800 focus:ring-4 focus:outline-none focus:ring-blue-300 font-medium rounded-lg text-sm px-5 py-2.5 text-center dark:bg-blue-600 dark:hover:bg-blue-700 dark:focus:ring-blue-800"></button>
                </div>
            </div>
        </div>
    </div>
</body>
<script>
    // set the modal menu element
    const $targetEl = document.getElementById('modalPopup');
    // instance options object
    const instanceOptions = {
        id: 'modalPopup',
        //override: true
    };
    // options with default values
    const options = {
        placement: 'center-center',
        backdrop: 'dynamic',
        backdropClasses:
            'bg-gray-900/50 dark:bg-gray-900/80 fixed inset-0 z-40',
        closable: true,
        onHide: () => {
            //console.log('modal is hidden');
        },
        onShow: () => {
            //console.log('modal is shown');
        },
        onToggle: () => {
            //console.log('modal has been toggled');
        },
    };
   const modal = new Modal($targetEl, options, instanceOptions);
</script>
<script src="js/dom.manipulation.js"></script>
<script src="js/time.process.js"></script>
<script src="js/home.js"></script>
</html>